<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Marriages in Pakistan | PSLM Stories</title>
  <meta name="description" content="5 Marriages in Pakistan | PSLM Stories" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Marriages in Pakistan | PSLM Stories" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Marriages in Pakistan | PSLM Stories" />
  
  
  

<meta name="author" content="Rabeez" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="employment.html"/>

<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">PSLM Stories</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>The PSLM Survey</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#this-repository"><i class="fa fa-check"></i><b>0.1</b> This repository</a></li>
</ul></li>
<li class="part"><span><b>I Sections of the survery</b></span></li>
<li class="chapter" data-level="1" data-path="the-household-roster.html"><a href="the-household-roster.html"><i class="fa fa-check"></i><b>1</b> The Household Roster</a></li>
<li class="chapter" data-level="2" data-path="education.html"><a href="education.html"><i class="fa fa-check"></i><b>2</b> Education</a></li>
<li class="chapter" data-level="3" data-path="health.html"><a href="health.html"><i class="fa fa-check"></i><b>3</b> Health</a></li>
<li class="chapter" data-level="4" data-path="employment.html"><a href="employment.html"><i class="fa fa-check"></i><b>4</b> Employment</a></li>
<li class="part"><span><b>II Detailed Analyses</b></span></li>
<li class="chapter" data-level="5" data-path="marriages-in-pakistan.html"><a href="marriages-in-pakistan.html"><i class="fa fa-check"></i><b>5</b> Marriages in Pakistan</a>
<ul>
<li class="chapter" data-level="5.1" data-path="marriages-in-pakistan.html"><a href="marriages-in-pakistan.html#underage-marriages"><i class="fa fa-check"></i><b>5.1</b> Underage marriages</a></li>
<li class="chapter" data-level="5.2" data-path="marriages-in-pakistan.html"><a href="marriages-in-pakistan.html#age-gap-in-couples"><i class="fa fa-check"></i><b>5.2</b> Age-gap in couples</a></li>
<li class="chapter" data-level="5.3" data-path="marriages-in-pakistan.html"><a href="marriages-in-pakistan.html#income-gap-in-couples"><i class="fa fa-check"></i><b>5.3</b> Income-gap in couples</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">PSLM Stories</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="marriages-in-pakistan" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Marriages in Pakistan</h1>
<p>There are many well-known problems regarding marriages in Pakistan like child marriage, forced marriage etc. I want to investigate these phenomenon through simple analysis of the Pakistan Social And Living Standards Measurement Survey (PSLM). This is the most frequent and up-to-date demographic survey conducted in Pakistan with sufficient detail to allow interesting explorations through the data.</p>
<p>I will be using R/tidyverse for the rest of the analysis.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb46-1"><a href="marriages-in-pakistan.html#cb46-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb46-2"><a href="marriages-in-pakistan.html#cb46-2"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb46-3"><a href="marriages-in-pakistan.html#cb46-3"></a><span class="fu">library</span>(scales)</span>
<span id="cb46-4"><a href="marriages-in-pakistan.html#cb46-4"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb46-5"><a href="marriages-in-pakistan.html#cb46-5"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb46-6"><a href="marriages-in-pakistan.html#cb46-6"></a><span class="fu">library</span>(ggforce)</span></code></pre></div>
<p>I load the survey roster data for each year and combine it into a single tibble/dataframe for easy analysis. There are a lot of columns which I don’t plan to use for this analysis so I just read the relevant ones in the appropriate datatypes also there are encoding issues in this table and some columns are missing from certain years. I can’t do much about the missing columns but I manually fix inconsistent encoding in factor columns and set certain sentinel values to NA using information from the questionnaire pdf. I also create a <code>has_spouse</code> column which I will extensively use for the analysis as a simplification of marital status which usually contains other statuses like divorced, engaged etc. Similarly I make an <code>age_group</code> column to group analyses/plots later.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb47-1"><a href="marriages-in-pakistan.html#cb47-1"></a>root_dir <span class="ot">&lt;-</span> <span class="st">&quot;C:/Users/R/Desktop/pslm/data_clean&quot;</span></span>
<span id="cb47-2"><a href="marriages-in-pakistan.html#cb47-2"></a>year_dirs <span class="ot">&lt;-</span> <span class="fu">head</span>(<span class="fu">list.dirs</span>(root_dir, <span class="at">recursive =</span> F), <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb47-3"><a href="marriages-in-pakistan.html#cb47-3"></a>all_files <span class="ot">&lt;-</span> <span class="fu">map</span>(year_dirs, <span class="cf">function</span>(year_dir) <span class="fu">paste</span>(year_dir, <span class="st">&quot;1 - HH_roster.csv&quot;</span>, <span class="at">sep=</span><span class="st">&quot;/&quot;</span>))</span>
<span id="cb47-4"><a href="marriages-in-pakistan.html#cb47-4"></a></span>
<span id="cb47-5"><a href="marriages-in-pakistan.html#cb47-5"></a><span class="co"># specifying columns which are missing from the file in cols_only() causes a warning</span></span>
<span id="cb47-6"><a href="marriages-in-pakistan.html#cb47-6"></a><span class="co"># since I can&#39;t do anything about missing columns I&#39;ve suppressed the warnings here</span></span>
<span id="cb47-7"><a href="marriages-in-pakistan.html#cb47-7"></a>roster <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(all_files, read_csv, <span class="at">col_types =</span> <span class="fu">cols_only</span>(<span class="at">year =</span> <span class="st">&quot;i&quot;</span>,</span>
<span id="cb47-8"><a href="marriages-in-pakistan.html#cb47-8"></a>                                                             <span class="at">hhcode =</span> <span class="st">&quot;d&quot;</span>,</span>
<span id="cb47-9"><a href="marriages-in-pakistan.html#cb47-9"></a>                                                             <span class="at">idc =</span> <span class="st">&quot;d&quot;</span>,</span>
<span id="cb47-10"><a href="marriages-in-pakistan.html#cb47-10"></a>                                                             <span class="at">sex =</span> <span class="st">&quot;f&quot;</span>,</span>
<span id="cb47-11"><a href="marriages-in-pakistan.html#cb47-11"></a>                                                             <span class="at">age =</span> <span class="st">&quot;d&quot;</span>,</span>
<span id="cb47-12"><a href="marriages-in-pakistan.html#cb47-12"></a>                                                             <span class="at">spouse_idc =</span> <span class="st">&quot;d&quot;</span>,</span>
<span id="cb47-13"><a href="marriages-in-pakistan.html#cb47-13"></a>                                                             <span class="at">province =</span> <span class="st">&quot;c&quot;</span>,</span>
<span id="cb47-14"><a href="marriages-in-pakistan.html#cb47-14"></a>                                                             <span class="at">district =</span> <span class="st">&quot;f&quot;</span>,</span>
<span id="cb47-15"><a href="marriages-in-pakistan.html#cb47-15"></a>                                                             <span class="at">region =</span> <span class="st">&quot;c&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-16"><a href="marriages-in-pakistan.html#cb47-16"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">floor_date</span>(<span class="fu">as.Date</span>(<span class="fu">as.character</span>(year), <span class="at">format=</span><span class="st">&quot;%Y&quot;</span>), <span class="at">unit =</span> <span class="st">&quot;year&quot;</span>),</span>
<span id="cb47-17"><a href="marriages-in-pakistan.html#cb47-17"></a>         <span class="at">spouse_idc =</span> <span class="fu">as.integer</span>(<span class="fu">na_if</span>(<span class="fu">na_if</span>(spouse_idc, <span class="dv">98</span>), <span class="dv">99</span>)),</span>
<span id="cb47-18"><a href="marriages-in-pakistan.html#cb47-18"></a>         <span class="at">region =</span> <span class="fu">as_factor</span>(<span class="fu">recode</span>(region, </span>
<span id="cb47-19"><a href="marriages-in-pakistan.html#cb47-19"></a>                                   <span class="at">rural =</span> <span class="st">&quot;Rural&quot;</span>, <span class="at">urban =</span> <span class="st">&quot;Urban&quot;</span>)),</span>
<span id="cb47-20"><a href="marriages-in-pakistan.html#cb47-20"></a>         <span class="at">province =</span> <span class="fu">as_factor</span>(<span class="fu">recode</span>(province, </span>
<span id="cb47-21"><a href="marriages-in-pakistan.html#cb47-21"></a>                                     <span class="at">punjab =</span> <span class="st">&quot;Punjab&quot;</span>, <span class="at">sindh =</span> <span class="st">&quot;Sindh&quot;</span>, <span class="at">nwfp =</span> <span class="st">&quot;KPK&quot;</span>, <span class="at">balochistan =</span> <span class="st">&quot;Balochistan&quot;</span>,</span>
<span id="cb47-22"><a href="marriages-in-pakistan.html#cb47-22"></a>                                     <span class="at">NWFP =</span> <span class="st">&quot;KPK&quot;</span>, <span class="st">&quot;khyber pakhtunkhwa&quot;</span> <span class="ot">=</span> <span class="st">&quot;KPK&quot;</span>, <span class="at">kpk =</span> <span class="st">&quot;KPK&quot;</span>, <span class="at">kp =</span> <span class="st">&quot;KPK&quot;</span>)),</span>
<span id="cb47-23"><a href="marriages-in-pakistan.html#cb47-23"></a>         <span class="at">has_spouse =</span> <span class="sc">!</span><span class="fu">is.na</span>(spouse_idc),</span>
<span id="cb47-24"><a href="marriages-in-pakistan.html#cb47-24"></a>         <span class="at">age_group =</span> <span class="fu">cut</span>(age, </span>
<span id="cb47-25"><a href="marriages-in-pakistan.html#cb47-25"></a>                         <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">12</span>, <span class="dv">19</span>, <span class="dv">30</span>, <span class="dv">60</span>, <span class="dv">100</span>), </span>
<span id="cb47-26"><a href="marriages-in-pakistan.html#cb47-26"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Child&quot;</span>, <span class="st">&quot;Teenager&quot;</span>, <span class="st">&quot;Young Adult&quot;</span>, <span class="st">&quot;Adult&quot;</span>, <span class="st">&quot;Senior&quot;</span>), </span>
<span id="cb47-27"><a href="marriages-in-pakistan.html#cb47-27"></a>                         <span class="at">ordered_result =</span> <span class="cn">TRUE</span>, <span class="at">include.lowest =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<p>Each individual in the survey is uniquely identified by a triplet of (year, hhcode, idc) where <code>year</code> is the year of survey, <code>hhcode</code> is household code/ID and <code>idc</code> is person ID <em>within the household</em>. There are some demographic variables telling age, sex, location of the individual. The <code>spouse_idc</code> column contains the ID code of the spouse of the individual (implicit fact: the spouse belongs to the same household). An NA here represents unmarried individuals.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb48-1"><a href="marriages-in-pakistan.html#cb48-1"></a><span class="fu">head</span>(roster)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 11
##   year           hhcode province district  region   idc sex     age spouse_idc
##   &lt;date&gt;          &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;     &lt;fct&gt;  &lt;dbl&gt; &lt;fct&gt; &lt;dbl&gt;      &lt;int&gt;
## 1 2004-01-01 1001200501 Punjab   islamabad Urban      2 male     27         NA
## 2 2004-01-01 1001200501 Punjab   islamabad Urban      3 male     25         NA
## 3 2004-01-01 1001300108 Punjab   islamabad Urban      6 male     34         NA
## 4 2004-01-01 1001300207 Punjab   islamabad Urban      6 male     26         NA
## 5 2004-01-01 1001300212 Punjab   islamabad Urban      2 male     70         NA
## 6 2004-01-01 1001300308 Punjab   islamabad Urban      3 male     40         NA
## # ... with 2 more variables: has_spouse &lt;lgl&gt;, age_group &lt;ord&gt;</code></pre>
<p>To see the number of married individuals I need to choose a single gender in order to avoid double counting since marriage is a symmetric relationship. It seems like there were no married people in 2004 and 2008 but this is obviously incorrect. The survey questionnaire did not contain a field for <code>spouse_idc</code> in these years. While we can use the <code>marital_status</code> column I have chosen to skip these years since I need the <code>spouse_idc</code> for the couple-level analysis I want to do.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb50-1"><a href="marriages-in-pakistan.html#cb50-1"></a>roster <span class="sc">%&gt;%</span> </span>
<span id="cb50-2"><a href="marriages-in-pakistan.html#cb50-2"></a>  <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">&quot;male&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="marriages-in-pakistan.html#cb50-3"></a>  <span class="fu">count</span>(year, has_spouse) <span class="sc">%&gt;%</span> </span>
<span id="cb50-4"><a href="marriages-in-pakistan.html#cb50-4"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span> </span>
<span id="cb50-5"><a href="marriages-in-pakistan.html#cb50-5"></a>  <span class="fu">mutate</span>(<span class="at">pct =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb50-6"><a href="marriages-in-pakistan.html#cb50-6"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> pct, <span class="at">fill =</span> has_spouse)) <span class="sc">+</span></span>
<span id="cb50-7"><a href="marriages-in-pakistan.html#cb50-7"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb50-8"><a href="marriages-in-pakistan.html#cb50-8"></a>  <span class="co"># scale_x_date(breaks = date_ticks, date_labels = &quot;%Y&quot;) +</span></span>
<span id="cb50-9"><a href="marriages-in-pakistan.html#cb50-9"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent) <span class="sc">+</span></span>
<span id="cb50-10"><a href="marriages-in-pakistan.html#cb50-10"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Marital Status over time&quot;</span>) <span class="sc">+</span></span>
<span id="cb50-11"><a href="marriages-in-pakistan.html#cb50-11"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Survey year&quot;</span>) <span class="sc">+</span></span>
<span id="cb50-12"><a href="marriages-in-pakistan.html#cb50-12"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Percentage of married individuals&quot;</span>)</span></code></pre></div>
<p><img src="p2-01-marriages_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div id="underage-marriages" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Underage marriages</h2>
<p>I want to see the youngest married individuals in each year. This looks very alarming since there are a lot of children with spouses in the dataset. Even more shocking is that none of the youngest married individuals are over the legal marriage age of 18.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb51-1"><a href="marriages-in-pakistan.html#cb51-1"></a>roster <span class="sc">%&gt;%</span> </span>
<span id="cb51-2"><a href="marriages-in-pakistan.html#cb51-2"></a>  <span class="fu">filter</span>(has_spouse) <span class="sc">%&gt;%</span> </span>
<span id="cb51-3"><a href="marriages-in-pakistan.html#cb51-3"></a>  <span class="fu">group_by</span>(year, region, sex) <span class="sc">%&gt;%</span> </span>
<span id="cb51-4"><a href="marriages-in-pakistan.html#cb51-4"></a>  <span class="fu">summarise</span>(<span class="at">age =</span> <span class="fu">min</span>(age)) <span class="sc">%&gt;%</span> </span>
<span id="cb51-5"><a href="marriages-in-pakistan.html#cb51-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> age, <span class="at">color =</span> sex, <span class="at">shape =</span> sex)) <span class="sc">+</span> </span>
<span id="cb51-6"><a href="marriages-in-pakistan.html#cb51-6"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb51-7"><a href="marriages-in-pakistan.html#cb51-7"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>region) <span class="sc">+</span> </span>
<span id="cb51-8"><a href="marriages-in-pakistan.html#cb51-8"></a>  <span class="co"># scale_x_date(breaks = date_ticks, date_labels = &quot;%Y&quot;) +</span></span>
<span id="cb51-9"><a href="marriages-in-pakistan.html#cb51-9"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Youngest married individuals&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-10"><a href="marriages-in-pakistan.html#cb51-10"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Survey year&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-11"><a href="marriages-in-pakistan.html#cb51-11"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Age&quot;</span>)</span></code></pre></div>
<p><img src="p2-01-marriages_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>In the numbers for just underage married individuals very few are below the age of 12 (children) and majority are in their teens (up to 17 only).</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb52-1"><a href="marriages-in-pakistan.html#cb52-1"></a>roster <span class="sc">%&gt;%</span> </span>
<span id="cb52-2"><a href="marriages-in-pakistan.html#cb52-2"></a>  <span class="fu">filter</span>(has_spouse, age <span class="sc">&lt;</span> <span class="dv">18</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb52-3"><a href="marriages-in-pakistan.html#cb52-3"></a>  <span class="fu">count</span>(year, age_group) <span class="sc">%&gt;%</span> </span>
<span id="cb52-4"><a href="marriages-in-pakistan.html#cb52-4"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> n, <span class="at">fill =</span> age_group)) <span class="sc">+</span> </span>
<span id="cb52-5"><a href="marriages-in-pakistan.html#cb52-5"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> </span>
<span id="cb52-6"><a href="marriages-in-pakistan.html#cb52-6"></a>  <span class="co"># scale_x_date(breaks = date_ticks, date_labels = &quot;%Y&quot;) +</span></span>
<span id="cb52-7"><a href="marriages-in-pakistan.html#cb52-7"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of underage married individuals&quot;</span>) <span class="sc">+</span></span>
<span id="cb52-8"><a href="marriages-in-pakistan.html#cb52-8"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Survey year&quot;</span>) <span class="sc">+</span></span>
<span id="cb52-9"><a href="marriages-in-pakistan.html#cb52-9"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Number of individuals&quot;</span>)</span></code></pre></div>
<p><img src="p2-01-marriages_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="age-gap-in-couples" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Age-gap in couples</h2>
<p>Now I will create couple pairings using <code>idc</code> and <code>spouse_idc</code> columns from the roster. At this point my unit-of-analysis is a couple instead of an individual so one row in my dataframe should correspond to one couple. This causes repetitive names since each couple contains two individuals. The variable of interest here is <code>age_gap</code> which shows how much older the husband is compared to the wife.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb53-1"><a href="marriages-in-pakistan.html#cb53-1"></a>males <span class="ot">&lt;-</span> roster <span class="sc">%&gt;%</span> </span>
<span id="cb53-2"><a href="marriages-in-pakistan.html#cb53-2"></a>  <span class="fu">filter</span>(has_spouse, sex <span class="sc">==</span> <span class="st">&quot;male&quot;</span>) </span>
<span id="cb53-3"><a href="marriages-in-pakistan.html#cb53-3"></a></span>
<span id="cb53-4"><a href="marriages-in-pakistan.html#cb53-4"></a>females <span class="ot">&lt;-</span> roster <span class="sc">%&gt;%</span> </span>
<span id="cb53-5"><a href="marriages-in-pakistan.html#cb53-5"></a>  <span class="fu">filter</span>(has_spouse, sex <span class="sc">==</span> <span class="st">&quot;female&quot;</span>) </span>
<span id="cb53-6"><a href="marriages-in-pakistan.html#cb53-6"></a>  </span>
<span id="cb53-7"><a href="marriages-in-pakistan.html#cb53-7"></a>couples <span class="ot">&lt;-</span> males <span class="sc">%&gt;%</span> </span>
<span id="cb53-8"><a href="marriages-in-pakistan.html#cb53-8"></a>  <span class="fu">inner_join</span>(females, </span>
<span id="cb53-9"><a href="marriages-in-pakistan.html#cb53-9"></a>             <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;spouse_idc&quot;</span> <span class="ot">=</span> <span class="st">&quot;idc&quot;</span>, <span class="st">&quot;hhcode&quot;</span> <span class="ot">=</span> <span class="st">&quot;hhcode&quot;</span>, <span class="st">&quot;year&quot;</span> <span class="ot">=</span> <span class="st">&quot;year&quot;</span>), </span>
<span id="cb53-10"><a href="marriages-in-pakistan.html#cb53-10"></a>             <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">&quot;.husband&quot;</span>, <span class="st">&quot;.wife&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb53-11"><a href="marriages-in-pakistan.html#cb53-11"></a>  <span class="fu">mutate</span>(<span class="at">age_gap =</span> age.husband <span class="sc">-</span> age.wife) <span class="sc">%&gt;%</span> </span>
<span id="cb53-12"><a href="marriages-in-pakistan.html#cb53-12"></a>  <span class="fu">rename</span>(<span class="at">province =</span> province.husband, <span class="at">district =</span> district.husband, <span class="at">region =</span> region.husband,</span>
<span id="cb53-13"><a href="marriages-in-pakistan.html#cb53-13"></a>         <span class="at">idc.husband =</span> idc, <span class="at">idc.wife =</span> spouse_idc) <span class="sc">%&gt;%</span> </span>
<span id="cb53-14"><a href="marriages-in-pakistan.html#cb53-14"></a>  <span class="fu">select</span>(<span class="sc">-</span>province.wife, <span class="sc">-</span>district.wife, <span class="sc">-</span>region.wife, <span class="sc">-</span>sex.husband, <span class="sc">-</span>sex.wife, </span>
<span id="cb53-15"><a href="marriages-in-pakistan.html#cb53-15"></a>         <span class="sc">-</span>has_spouse.husband, <span class="sc">-</span>has_spouse.wife, <span class="sc">-</span>spouse_idc.wife) <span class="sc">%&gt;%</span> </span>
<span id="cb53-16"><a href="marriages-in-pakistan.html#cb53-16"></a>  <span class="fu">select</span>(year, hhcode, province, district, region, </span>
<span id="cb53-17"><a href="marriages-in-pakistan.html#cb53-17"></a>         idc.husband, age.husband, age_group.husband,</span>
<span id="cb53-18"><a href="marriages-in-pakistan.html#cb53-18"></a>         idc.wife, age.wife, age_group.wife,</span>
<span id="cb53-19"><a href="marriages-in-pakistan.html#cb53-19"></a>         age_gap)</span>
<span id="cb53-20"><a href="marriages-in-pakistan.html#cb53-20"></a></span>
<span id="cb53-21"><a href="marriages-in-pakistan.html#cb53-21"></a><span class="co"># temporary tables removed after use to free up memory</span></span>
<span id="cb53-22"><a href="marriages-in-pakistan.html#cb53-22"></a><span class="fu">rm</span>(males, females)</span>
<span id="cb53-23"><a href="marriages-in-pakistan.html#cb53-23"></a></span>
<span id="cb53-24"><a href="marriages-in-pakistan.html#cb53-24"></a><span class="fu">head</span>(couples)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 12
##   year           hhcode province district region idc.husband age.husband
##   &lt;date&gt;          &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;    &lt;fct&gt;        &lt;dbl&gt;       &lt;dbl&gt;
## 1 2005-01-01 1011010101 Punjab   &lt;NA&gt;     Urban            1          64
## 2 2005-01-01 1011010102 Punjab   &lt;NA&gt;     Urban            1          35
## 3 2005-01-01 1011010103 Punjab   &lt;NA&gt;     Urban            1          70
## 4 2005-01-01 1011010104 Punjab   &lt;NA&gt;     Urban            1          40
## 5 2005-01-01 1011010105 Punjab   &lt;NA&gt;     Urban            1          49
## 6 2005-01-01 1011010106 Punjab   &lt;NA&gt;     Urban            1          30
## # ... with 5 more variables: age_group.husband &lt;ord&gt;, idc.wife &lt;dbl&gt;,
## #   age.wife &lt;dbl&gt;, age_group.wife &lt;ord&gt;, age_gap &lt;dbl&gt;</code></pre>
<p>The first thing I want to see is if there is any correlation between the ages of spouses. There appears to be a near-perfect linear trend as seen with the reference diagonal line (representing no age gap). Most of the points are to the lower-right of the line meaning most couples have a slightly older husband. An interesting thing to note here is that there are more men with the max age (99) than women. In the questionnaire age over 100 is supposed to be represented as 99.</p>
<p>There are more outliers with large age gaps in the lower-right triangle than in the upper-left one. This means that where are more couples where the husband is older than the wife. There also seem to be more couples with older husbands in rural region.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb55-1"><a href="marriages-in-pakistan.html#cb55-1"></a><span class="fu">ggplot</span>(couples, <span class="fu">aes</span>(<span class="at">x =</span> age.husband, <span class="at">y =</span> age.wife)) <span class="sc">+</span> </span>
<span id="cb55-2"><a href="marriages-in-pakistan.html#cb55-2"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">abs</span>(age_gap) <span class="sc">&gt;</span> <span class="dv">30</span>), <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb55-3"><a href="marriages-in-pakistan.html#cb55-3"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#C3C3C3&quot;</span>, <span class="st">&quot;#198D8D&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb55-4"><a href="marriages-in-pakistan.html#cb55-4"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb55-5"><a href="marriages-in-pakistan.html#cb55-5"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb55-6"><a href="marriages-in-pakistan.html#cb55-6"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> region) <span class="sc">+</span> </span>
<span id="cb55-7"><a href="marriages-in-pakistan.html#cb55-7"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Husband&#39;s age&quot;</span>) <span class="sc">+</span></span>
<span id="cb55-8"><a href="marriages-in-pakistan.html#cb55-8"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Wife&#39;s age&quot;</span>)</span></code></pre></div>
<p><img src="p2-01-marriages_files/figure-html/unnamed-chunk-8-1.png" width="960" /></p>
<p>avg by district</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb56-1"><a href="marriages-in-pakistan.html#cb56-1"></a>couples <span class="sc">%&gt;%</span> </span>
<span id="cb56-2"><a href="marriages-in-pakistan.html#cb56-2"></a>  <span class="fu">group_by</span>(region, district) <span class="sc">%&gt;%</span> </span>
<span id="cb56-3"><a href="marriages-in-pakistan.html#cb56-3"></a>  <span class="fu">summarise</span>(<span class="at">avg_age.husband =</span> <span class="fu">median</span>(age.husband),</span>
<span id="cb56-4"><a href="marriages-in-pakistan.html#cb56-4"></a>            <span class="at">avg_age.wife =</span> <span class="fu">median</span>(age.wife)) <span class="sc">%&gt;%</span> </span>
<span id="cb56-5"><a href="marriages-in-pakistan.html#cb56-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> avg_age.husband, <span class="at">y =</span> avg_age.wife, <span class="at">color =</span> region)) <span class="sc">+</span> </span>
<span id="cb56-6"><a href="marriages-in-pakistan.html#cb56-6"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span> </span>
<span id="cb56-7"><a href="marriages-in-pakistan.html#cb56-7"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb56-8"><a href="marriages-in-pakistan.html#cb56-8"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb56-9"><a href="marriages-in-pakistan.html#cb56-9"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Average husband&#39;s age&quot;</span>) <span class="sc">+</span></span>
<span id="cb56-10"><a href="marriages-in-pakistan.html#cb56-10"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Average wife&#39;s age&quot;</span>)</span></code></pre></div>
<p><img src="p2-01-marriages_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>The distribution of age gap over the years has remained pretty consistent. The age gap for rural couples is much more tightly distributed around the mean than the urban even though in the previous chart we saw that rural region has more extreme values (this isn’t visible in this chart because of small scale).</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb57-1"><a href="marriages-in-pakistan.html#cb57-1"></a><span class="fu">ggplot</span>(couples, <span class="fu">aes</span>(<span class="at">x =</span> age_gap, <span class="at">y =</span> <span class="fu">after_stat</span>(density), <span class="at">fill =</span> region)) <span class="sc">+</span></span>
<span id="cb57-2"><a href="marriages-in-pakistan.html#cb57-2"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb57-3"><a href="marriages-in-pakistan.html#cb57-3"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> year) <span class="sc">+</span> </span>
<span id="cb57-4"><a href="marriages-in-pakistan.html#cb57-4"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of Age gap by Year and Region&quot;</span>, </span>
<span id="cb57-5"><a href="marriages-in-pakistan.html#cb57-5"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Positive gap denotes older husband and vice versa&quot;</span>) <span class="sc">+</span></span>
<span id="cb57-6"><a href="marriages-in-pakistan.html#cb57-6"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Age gap&quot;</span>)</span></code></pre></div>
<p><img src="p2-01-marriages_files/figure-html/unnamed-chunk-10-1.png" width="960" /></p>
<p>Since there are no differences across years we can ignore that dimension and look more closely at differences across regions.</p>
<p>In both regions the median is positive most couples have a slightly older husband. The rural region does indeed have a tighter distribution around 0 but it also has more extreme cases. Qualitatively, it seems like in rural areas it is much more likely to have a partner almost exactly the same age as you or to have a much older husband (more common) or wife (less common).</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb58-1"><a href="marriages-in-pakistan.html#cb58-1"></a>median_gap_by_region <span class="ot">&lt;-</span> couples <span class="sc">%&gt;%</span> </span>
<span id="cb58-2"><a href="marriages-in-pakistan.html#cb58-2"></a>  <span class="fu">group_by</span>(region) <span class="sc">%&gt;%</span> </span>
<span id="cb58-3"><a href="marriages-in-pakistan.html#cb58-3"></a>  <span class="fu">summarise</span>(<span class="at">med =</span> <span class="fu">median</span>(age_gap)) <span class="sc">%&gt;%</span> </span>
<span id="cb58-4"><a href="marriages-in-pakistan.html#cb58-4"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">str_c</span>(<span class="st">&#39;Median:&#39;</span>, <span class="fu">format</span>(med, <span class="at">nsmall =</span> <span class="dv">1</span>)))</span>
<span id="cb58-5"><a href="marriages-in-pakistan.html#cb58-5"></a></span>
<span id="cb58-6"><a href="marriages-in-pakistan.html#cb58-6"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb58-7"><a href="marriages-in-pakistan.html#cb58-7"></a>  <span class="fu">geom_boxplot</span>(<span class="at">data =</span> couples, </span>
<span id="cb58-8"><a href="marriages-in-pakistan.html#cb58-8"></a>               <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> age_gap, <span class="at">y =</span> region, <span class="at">color =</span> region), </span>
<span id="cb58-9"><a href="marriages-in-pakistan.html#cb58-9"></a>               <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb58-10"><a href="marriages-in-pakistan.html#cb58-10"></a>  <span class="fu">geom_label_repel</span>(<span class="at">data =</span> median_gap_by_region, </span>
<span id="cb58-11"><a href="marriages-in-pakistan.html#cb58-11"></a>                  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> med, <span class="at">y =</span> region, <span class="at">label =</span> label)) <span class="sc">+</span> </span>
<span id="cb58-12"><a href="marriages-in-pakistan.html#cb58-12"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of Age gap by Region&quot;</span>, </span>
<span id="cb58-13"><a href="marriages-in-pakistan.html#cb58-13"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Positive gap denotes older husband and vice versa&quot;</span>) <span class="sc">+</span></span>
<span id="cb58-14"><a href="marriages-in-pakistan.html#cb58-14"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Age gap&quot;</span>) <span class="sc">+</span> </span>
<span id="cb58-15"><a href="marriages-in-pakistan.html#cb58-15"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Region&quot;</span>)</span></code></pre></div>
<p><img src="p2-01-marriages_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="income-gap-in-couples" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Income-gap in couples</h2>
<p>Let’s load the income data from PSLM files as well.</p>
<p><em>Since this is just an illustrative exercise for simplicity I am only looking at reported annual cash income.</em></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb59-1"><a href="marriages-in-pakistan.html#cb59-1"></a>all_files <span class="ot">&lt;-</span> <span class="fu">map</span>(year_dirs, <span class="cf">function</span>(year_dir) <span class="fu">paste</span>(year_dir, <span class="st">&quot;4 - Employment.csv&quot;</span>, <span class="at">sep=</span><span class="st">&quot;/&quot;</span>))</span>
<span id="cb59-2"><a href="marriages-in-pakistan.html#cb59-2"></a></span>
<span id="cb59-3"><a href="marriages-in-pakistan.html#cb59-3"></a><span class="co"># specifying columns which are missing from the file in cols_only() causes a warning</span></span>
<span id="cb59-4"><a href="marriages-in-pakistan.html#cb59-4"></a><span class="co"># since I can&#39;t do anything about missing columns I&#39;ve suppressed the warnings here</span></span>
<span id="cb59-5"><a href="marriages-in-pakistan.html#cb59-5"></a>income <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(all_files, read_csv, <span class="at">col_types =</span> <span class="fu">cols_only</span>(<span class="at">year =</span> <span class="st">&quot;i&quot;</span>,</span>
<span id="cb59-6"><a href="marriages-in-pakistan.html#cb59-6"></a>                                                             <span class="at">hhcode =</span> <span class="st">&quot;d&quot;</span>,</span>
<span id="cb59-7"><a href="marriages-in-pakistan.html#cb59-7"></a>                                                             <span class="at">idc =</span> <span class="st">&quot;d&quot;</span>,</span>
<span id="cb59-8"><a href="marriages-in-pakistan.html#cb59-8"></a>                                                             <span class="at">work1_income_last_month =</span> <span class="st">&quot;d&quot;</span>,</span>
<span id="cb59-9"><a href="marriages-in-pakistan.html#cb59-9"></a>                                                             <span class="at">work1_months_worked_last_year   =</span> <span class="st">&quot;d&quot;</span>,</span>
<span id="cb59-10"><a href="marriages-in-pakistan.html#cb59-10"></a>                                                             <span class="at">work1_income_last_year =</span> <span class="st">&quot;d&quot;</span>,</span>
<span id="cb59-11"><a href="marriages-in-pakistan.html#cb59-11"></a>                                                             <span class="at">work1_occupation =</span> <span class="st">&quot;c&quot;</span>,</span>
<span id="cb59-12"><a href="marriages-in-pakistan.html#cb59-12"></a>                                                             <span class="at">work1_industry =</span> <span class="st">&quot;c&quot;</span>,</span>
<span id="cb59-13"><a href="marriages-in-pakistan.html#cb59-13"></a>                                                             <span class="at">province =</span> <span class="st">&quot;c&quot;</span>,</span>
<span id="cb59-14"><a href="marriages-in-pakistan.html#cb59-14"></a>                                                             <span class="at">region =</span> <span class="st">&quot;c&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb59-15"><a href="marriages-in-pakistan.html#cb59-15"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">floor_date</span>(<span class="fu">as.Date</span>(<span class="fu">as.character</span>(year), <span class="at">format=</span><span class="st">&quot;%Y&quot;</span>), <span class="at">unit =</span> <span class="st">&quot;year&quot;</span>),</span>
<span id="cb59-16"><a href="marriages-in-pakistan.html#cb59-16"></a>         <span class="at">region =</span> <span class="fu">as_factor</span>(<span class="fu">recode</span>(region, </span>
<span id="cb59-17"><a href="marriages-in-pakistan.html#cb59-17"></a>                                   <span class="at">rural =</span> <span class="st">&quot;Rural&quot;</span>, <span class="at">urban =</span> <span class="st">&quot;Urban&quot;</span>)),</span>
<span id="cb59-18"><a href="marriages-in-pakistan.html#cb59-18"></a>         <span class="at">province =</span> <span class="fu">as_factor</span>(<span class="fu">recode</span>(province, </span>
<span id="cb59-19"><a href="marriages-in-pakistan.html#cb59-19"></a>                                     <span class="at">punjab =</span> <span class="st">&quot;Punjab&quot;</span>, <span class="at">sindh =</span> <span class="st">&quot;Sindh&quot;</span>, <span class="at">nwfp =</span> <span class="st">&quot;KPK&quot;</span>, <span class="at">balochistan =</span> <span class="st">&quot;Balochistan&quot;</span>,</span>
<span id="cb59-20"><a href="marriages-in-pakistan.html#cb59-20"></a>                                     <span class="at">NWFP =</span> <span class="st">&quot;KPK&quot;</span>, <span class="st">&quot;khyber pakhtunkhwa&quot;</span> <span class="ot">=</span> <span class="st">&quot;KPK&quot;</span>, <span class="at">kpk =</span> <span class="st">&quot;KPK&quot;</span>, <span class="at">kp =</span> <span class="st">&quot;KPK&quot;</span>)),</span>
<span id="cb59-21"><a href="marriages-in-pakistan.html#cb59-21"></a>         <span class="at">work1_income_last_year.calc =</span> work1_income_last_month <span class="sc">*</span> work1_income_last_month,</span>
<span id="cb59-22"><a href="marriages-in-pakistan.html#cb59-22"></a>         <span class="at">work1_occupation =</span> <span class="fu">as_factor</span>(<span class="fu">str_to_sentence</span>(work1_occupation)),</span>
<span id="cb59-23"><a href="marriages-in-pakistan.html#cb59-23"></a>         <span class="at">work1_industry =</span> <span class="fu">as_factor</span>(<span class="fu">str_to_sentence</span>(work1_industry)),</span>
<span id="cb59-24"><a href="marriages-in-pakistan.html#cb59-24"></a>         <span class="co"># age_group = cut(age, </span></span>
<span id="cb59-25"><a href="marriages-in-pakistan.html#cb59-25"></a>         <span class="co">#                 breaks = c(0, 12, 19, 30, 60, 100), </span></span>
<span id="cb59-26"><a href="marriages-in-pakistan.html#cb59-26"></a>         <span class="co">#                 labels = c(&quot;Child&quot;, &quot;Teenager&quot;, &quot;Young Adult&quot;, &quot;Adult&quot;, &quot;Senior&quot;), </span></span>
<span id="cb59-27"><a href="marriages-in-pakistan.html#cb59-27"></a>         <span class="co">#                 ordered_result = TRUE, include.lowest = TRUE)</span></span>
<span id="cb59-28"><a href="marriages-in-pakistan.html#cb59-28"></a>         )</span></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb60-1"><a href="marriages-in-pakistan.html#cb60-1"></a><span class="fu">head</span>(income)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 11
##   year        hhcode province region   idc work1_occupation     work1_industry  
##   &lt;date&gt;       &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;  &lt;dbl&gt; &lt;fct&gt;                &lt;fct&gt;           
## 1 2004-01-01  1.00e9 Punjab   Urban      1 Service, shop , sal~ Social &amp; person~
## 2 2004-01-01  1.00e9 Punjab   Urban      2 Service, shop , sal~ Social &amp; person~
## 3 2004-01-01  1.00e9 Punjab   Urban      3 &lt;NA&gt;                 &lt;NA&gt;            
## 4 2004-01-01  1.00e9 Punjab   Urban      4 &lt;NA&gt;                 &lt;NA&gt;            
## 5 2004-01-01  1.00e9 Punjab   Urban      1 Service, shop , sal~ Social &amp; person~
## 6 2004-01-01  1.00e9 Punjab   Urban      2 &lt;NA&gt;                 &lt;NA&gt;            
## # ... with 4 more variables: work1_income_last_month &lt;dbl&gt;,
## #   work1_months_worked_last_year &lt;dbl&gt;, work1_income_last_year &lt;dbl&gt;,
## #   work1_income_last_year.calc &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb62-1"><a href="marriages-in-pakistan.html#cb62-1"></a>plot_categorical <span class="ot">&lt;-</span> <span class="cf">function</span>(tbl, cat_col, <span class="at">n_levels =</span> <span class="dv">10</span>, </span>
<span id="cb62-2"><a href="marriages-in-pakistan.html#cb62-2"></a>                             order_col, order_fun, </span>
<span id="cb62-3"><a href="marriages-in-pakistan.html#cb62-3"></a>                             <span class="at">do_agg =</span> <span class="cn">FALSE</span>, <span class="at">agg_col =</span> <span class="cn">NULL</span>, <span class="at">agg_fun =</span> <span class="cn">NULL</span>) {</span>
<span id="cb62-4"><a href="marriages-in-pakistan.html#cb62-4"></a>  result <span class="ot">&lt;-</span> tbl <span class="sc">%&gt;%</span> </span>
<span id="cb62-5"><a href="marriages-in-pakistan.html#cb62-5"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>({{ cat_col }})) <span class="sc">%&gt;%</span></span>
<span id="cb62-6"><a href="marriages-in-pakistan.html#cb62-6"></a>    <span class="fu">mutate</span>({{ cat_col }} <span class="sc">:</span><span class="er">=</span> <span class="fu">fct_lump_n</span>({{ cat_col }}, n_levels),</span>
<span id="cb62-7"><a href="marriages-in-pakistan.html#cb62-7"></a>           {{ cat_col }} <span class="sc">:</span><span class="er">=</span> <span class="fu">fct_reorder</span>({{ cat_col }}, {{ order_col }}, <span class="at">.fun =</span> order_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb62-8"><a href="marriages-in-pakistan.html#cb62-8"></a>    <span class="fu">group_by</span>({{ cat_col }}, region)</span>
<span id="cb62-9"><a href="marriages-in-pakistan.html#cb62-9"></a>  </span>
<span id="cb62-10"><a href="marriages-in-pakistan.html#cb62-10"></a>  <span class="cf">if</span> (do_agg) {</span>
<span id="cb62-11"><a href="marriages-in-pakistan.html#cb62-11"></a>    <span class="fu">print</span>(<span class="fu">c</span>(<span class="st">&quot;h1&quot;</span>, <span class="fu">substitute</span>(agg_fun), <span class="fu">as.character</span>(<span class="fu">enquo</span>(agg_col))))</span>
<span id="cb62-12"><a href="marriages-in-pakistan.html#cb62-12"></a>    <span class="fu">print</span>(result)</span>
<span id="cb62-13"><a href="marriages-in-pakistan.html#cb62-13"></a>    result <span class="ot">&lt;-</span> result <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">aggregated =</span> <span class="fu">agg_fun</span>({{agg_col}}))</span>
<span id="cb62-14"><a href="marriages-in-pakistan.html#cb62-14"></a>    <span class="co"># print(result)</span></span>
<span id="cb62-15"><a href="marriages-in-pakistan.html#cb62-15"></a>  } <span class="cf">else</span> {</span>
<span id="cb62-16"><a href="marriages-in-pakistan.html#cb62-16"></a>    <span class="co"># print(c(&quot;h2&quot;, agg_col))</span></span>
<span id="cb62-17"><a href="marriages-in-pakistan.html#cb62-17"></a>    <span class="co"># This will run for count aggregations only</span></span>
<span id="cb62-18"><a href="marriages-in-pakistan.html#cb62-18"></a>    result <span class="ot">&lt;-</span> result <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">aggregated =</span> <span class="fu">n</span>())</span>
<span id="cb62-19"><a href="marriages-in-pakistan.html#cb62-19"></a>  }</span>
<span id="cb62-20"><a href="marriages-in-pakistan.html#cb62-20"></a>  </span>
<span id="cb62-21"><a href="marriages-in-pakistan.html#cb62-21"></a>  result <span class="sc">%&gt;%</span> </span>
<span id="cb62-22"><a href="marriages-in-pakistan.html#cb62-22"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(aggregated, {{ cat_col }}, <span class="at">fill =</span> region)) <span class="sc">+</span></span>
<span id="cb62-23"><a href="marriages-in-pakistan.html#cb62-23"></a>    <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb62-24"><a href="marriages-in-pakistan.html#cb62-24"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">label_comma</span>())</span>
<span id="cb62-25"><a href="marriages-in-pakistan.html#cb62-25"></a>}</span>
<span id="cb62-26"><a href="marriages-in-pakistan.html#cb62-26"></a></span>
<span id="cb62-27"><a href="marriages-in-pakistan.html#cb62-27"></a>income <span class="sc">%&gt;%</span> </span>
<span id="cb62-28"><a href="marriages-in-pakistan.html#cb62-28"></a>  <span class="fu">plot_categorical</span>(work1_occupation, <span class="dv">15</span>, hhcode, length) <span class="sc">+</span></span>
<span id="cb62-29"><a href="marriages-in-pakistan.html#cb62-29"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Number of people by Occupation&quot;</span>)</span></code></pre></div>
<p><img src="p2-01-marriages_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb63-1"><a href="marriages-in-pakistan.html#cb63-1"></a>income <span class="sc">%&gt;%</span> </span>
<span id="cb63-2"><a href="marriages-in-pakistan.html#cb63-2"></a>  <span class="fu">plot_categorical</span>(work1_industry, <span class="dv">15</span>, hhcode, length) <span class="sc">+</span></span>
<span id="cb63-3"><a href="marriages-in-pakistan.html#cb63-3"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Number of people by Industry&quot;</span>)</span></code></pre></div>
<p><img src="p2-01-marriages_files/figure-html/unnamed-chunk-14-2.png" width="672" /></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb64-1"><a href="marriages-in-pakistan.html#cb64-1"></a>income <span class="sc">%&gt;%</span> </span>
<span id="cb64-2"><a href="marriages-in-pakistan.html#cb64-2"></a>  <span class="fu">plot_categorical</span>(work1_occupation, <span class="dv">15</span>, work1_income_last_year, median, <span class="cn">TRUE</span>, work1_income_last_year, median) <span class="sc">+</span></span>
<span id="cb64-3"><a href="marriages-in-pakistan.html#cb64-3"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Median annual salary by Occupation&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Using `as.character()` on a quosure is deprecated as of rlang 0.3.0.
## Please use `as_label()` or `as_name()` instead.
## This warning is displayed once per session.</code></pre>
<pre><code>## [[1]]
## [1] &quot;h1&quot;
## 
## [[2]]
## median
## 
## [[3]]
## [1] &quot;~&quot;
## 
## [[4]]
## [1] &quot;work1_income_last_year&quot;
## 
## # A tibble: 1,046,386 x 11
## # Groups:   work1_occupation, region [32]
##    year        hhcode province region   idc work1_occupation    work1_industry  
##    &lt;date&gt;       &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;  &lt;dbl&gt; &lt;fct&gt;               &lt;fct&gt;           
##  1 2004-01-01  1.00e9 Punjab   Urban      1 Service, shop , sa~ Social &amp; person~
##  2 2004-01-01  1.00e9 Punjab   Urban      2 Service, shop , sa~ Social &amp; person~
##  3 2004-01-01  1.00e9 Punjab   Urban      1 Service, shop , sa~ Social &amp; person~
##  4 2004-01-01  1.00e9 Punjab   Urban      1 Professionals       Social &amp; person~
##  5 2004-01-01  1.00e9 Punjab   Urban      1 Elementary occupat~ Social &amp; person~
##  6 2004-01-01  1.00e9 Punjab   Urban      1 Professionals       Social &amp; person~
##  7 2004-01-01  1.00e9 Punjab   Urban      8 Other               Social &amp; person~
##  8 2004-01-01  1.00e9 Punjab   Urban      1 Other               Electricity     
##  9 2004-01-01  1.00e9 Punjab   Urban      3 Service, shop , sa~ Social &amp; person~
## 10 2004-01-01  1.00e9 Punjab   Urban      1 Other               Social &amp; person~
## # ... with 1,046,376 more rows, and 4 more variables:
## #   work1_income_last_month &lt;dbl&gt;, work1_months_worked_last_year &lt;dbl&gt;,
## #   work1_income_last_year &lt;dbl&gt;, work1_income_last_year.calc &lt;dbl&gt;</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;work1_occupation&#39;. You can override using the `.groups` argument.</code></pre>
<pre><code>## Warning: Removed 32 rows containing missing values (position_stack).</code></pre>
<p><img src="p2-01-marriages_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb69-1"><a href="marriages-in-pakistan.html#cb69-1"></a>income <span class="sc">%&gt;%</span> </span>
<span id="cb69-2"><a href="marriages-in-pakistan.html#cb69-2"></a>  <span class="fu">plot_categorical</span>(work1_industry, <span class="dv">15</span>, work1_income_last_year, median, <span class="cn">TRUE</span>, work1_income_last_year, median) <span class="sc">+</span></span>
<span id="cb69-3"><a href="marriages-in-pakistan.html#cb69-3"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Median annual salary by Industry&quot;</span>)</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;h1&quot;
## 
## [[2]]
## median
## 
## [[3]]
## [1] &quot;~&quot;
## 
## [[4]]
## [1] &quot;work1_income_last_year&quot;
## 
## # A tibble: 1,046,461 x 11
## # Groups:   work1_industry, region [30]
##    year        hhcode province region   idc work1_occupation    work1_industry  
##    &lt;date&gt;       &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;  &lt;dbl&gt; &lt;fct&gt;               &lt;fct&gt;           
##  1 2004-01-01  1.00e9 Punjab   Urban      1 Service, shop , sa~ Social &amp; person~
##  2 2004-01-01  1.00e9 Punjab   Urban      2 Service, shop , sa~ Social &amp; person~
##  3 2004-01-01  1.00e9 Punjab   Urban      1 Service, shop , sa~ Social &amp; person~
##  4 2004-01-01  1.00e9 Punjab   Urban      1 Professionals       Social &amp; person~
##  5 2004-01-01  1.00e9 Punjab   Urban      1 Elementary occupat~ Social &amp; person~
##  6 2004-01-01  1.00e9 Punjab   Urban      1 Professionals       Social &amp; person~
##  7 2004-01-01  1.00e9 Punjab   Urban      8 Senior officals / ~ Social &amp; person~
##  8 2004-01-01  1.00e9 Punjab   Urban      1 Clerks              Other           
##  9 2004-01-01  1.00e9 Punjab   Urban      3 Service, shop , sa~ Social &amp; person~
## 10 2004-01-01  1.00e9 Punjab   Urban      1 Clerks              Social &amp; person~
## # ... with 1,046,451 more rows, and 4 more variables:
## #   work1_income_last_month &lt;dbl&gt;, work1_months_worked_last_year &lt;dbl&gt;,
## #   work1_income_last_year &lt;dbl&gt;, work1_income_last_year.calc &lt;dbl&gt;</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;work1_industry&#39;. You can override using the `.groups` argument.</code></pre>
<pre><code>## Warning: Removed 30 rows containing missing values (position_stack).</code></pre>
<p><img src="p2-01-marriages_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<p>income over time</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb73-1"><a href="marriages-in-pakistan.html#cb73-1"></a>income <span class="sc">%&gt;%</span> </span>
<span id="cb73-2"><a href="marriages-in-pakistan.html#cb73-2"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(work1_income_last_year)) <span class="sc">%&gt;%</span> </span>
<span id="cb73-3"><a href="marriages-in-pakistan.html#cb73-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> work1_income_last_year, <span class="at">group =</span> <span class="fu">interaction</span>(year, region), <span class="at">fill =</span> region)) <span class="sc">+</span> </span>
<span id="cb73-4"><a href="marriages-in-pakistan.html#cb73-4"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb73-5"><a href="marriages-in-pakistan.html#cb73-5"></a>  <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> <span class="fu">label_comma</span>()) <span class="sc">+</span> </span>
<span id="cb73-6"><a href="marriages-in-pakistan.html#cb73-6"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Annual Income (PKR)&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Transformation introduced infinite values in continuous y-axis</code></pre>
<pre><code>## Warning: Removed 514316 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="p2-01-marriages_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>income over time married/unmarried by sex</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb76-1"><a href="marriages-in-pakistan.html#cb76-1"></a>roster_enriched <span class="ot">&lt;-</span> roster <span class="sc">%&gt;%</span> </span>
<span id="cb76-2"><a href="marriages-in-pakistan.html#cb76-2"></a>  <span class="fu">left_join</span>(income <span class="sc">%&gt;%</span> <span class="fu">select</span>(year,hhcode,idc,work1_income_last_year,work1_occupation,work1_industry),<span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;year&quot;</span>,<span class="st">&quot;hhcode&quot;</span>,<span class="st">&quot;idc&quot;</span>))</span>
<span id="cb76-3"><a href="marriages-in-pakistan.html#cb76-3"></a></span>
<span id="cb76-4"><a href="marriages-in-pakistan.html#cb76-4"></a><span class="fu">head</span>(roster_enriched)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 14
##   year           hhcode province district  region   idc sex     age spouse_idc
##   &lt;date&gt;          &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;     &lt;fct&gt;  &lt;dbl&gt; &lt;fct&gt; &lt;dbl&gt;      &lt;int&gt;
## 1 2004-01-01 1001200501 Punjab   islamabad Urban      2 male     27         NA
## 2 2004-01-01 1001200501 Punjab   islamabad Urban      3 male     25         NA
## 3 2004-01-01 1001300108 Punjab   islamabad Urban      6 male     34         NA
## 4 2004-01-01 1001300207 Punjab   islamabad Urban      6 male     26         NA
## 5 2004-01-01 1001300212 Punjab   islamabad Urban      2 male     70         NA
## 6 2004-01-01 1001300308 Punjab   islamabad Urban      3 male     40         NA
## # ... with 5 more variables: has_spouse &lt;lgl&gt;, age_group &lt;ord&gt;,
## #   work1_income_last_year &lt;dbl&gt;, work1_occupation &lt;fct&gt;, work1_industry &lt;fct&gt;</code></pre>
<p>There is a slight bimodal pattern in the income distribution.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb78-1"><a href="marriages-in-pakistan.html#cb78-1"></a>roster_enriched <span class="sc">%&gt;%</span></span>
<span id="cb78-2"><a href="marriages-in-pakistan.html#cb78-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(work1_income_last_year)) <span class="sc">+</span> </span>
<span id="cb78-3"><a href="marriages-in-pakistan.html#cb78-3"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span> </span>
<span id="cb78-4"><a href="marriages-in-pakistan.html#cb78-4"></a>  <span class="fu">scale_x_log10</span>(<span class="at">labels =</span> comma)</span></code></pre></div>
<pre><code>## Warning: Transformation introduced infinite values in continuous x-axis</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 3416798 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="p2-01-marriages_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>effect of age and marriage on income. The second mode is significantly stronger in unmarried rural people.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb82-1"><a href="marriages-in-pakistan.html#cb82-1"></a>roster_enriched <span class="sc">%&gt;%</span> </span>
<span id="cb82-2"><a href="marriages-in-pakistan.html#cb82-2"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(work1_income_last_year), work1_income_last_year <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb82-3"><a href="marriages-in-pakistan.html#cb82-3"></a>         <span class="sc">!</span><span class="fu">is.na</span>(age)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-4"><a href="marriages-in-pakistan.html#cb82-4"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> work1_income_last_year, <span class="at">color =</span> has_spouse)) <span class="sc">+</span> </span>
<span id="cb82-5"><a href="marriages-in-pakistan.html#cb82-5"></a>  <span class="fu">geom_mark_ellipse</span>(<span class="fu">aes</span>(<span class="at">filter =</span> <span class="fu">between</span>(work1_income_last_year, <span class="dv">50</span>, <span class="dv">1000</span>) <span class="sc">&amp;</span> <span class="fu">between</span>(age, <span class="dv">20</span>, <span class="dv">80</span>)), </span>
<span id="cb82-6"><a href="marriages-in-pakistan.html#cb82-6"></a>                    <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb82-7"><a href="marriages-in-pakistan.html#cb82-7"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb82-8"><a href="marriages-in-pakistan.html#cb82-8"></a>  <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> <span class="fu">label_comma</span>()) <span class="sc">+</span></span>
<span id="cb82-9"><a href="marriages-in-pakistan.html#cb82-9"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="dv">1</span>))) <span class="sc">+</span> </span>
<span id="cb82-10"><a href="marriages-in-pakistan.html#cb82-10"></a>  <span class="fu">facet_grid</span>(has_spouse <span class="sc">~</span> region) <span class="sc">+</span></span>
<span id="cb82-11"><a href="marriages-in-pakistan.html#cb82-11"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Age&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Annual Income (PKR)&quot;</span>, <span class="at">color =</span> <span class="st">&quot;Married?&quot;</span>)</span></code></pre></div>
<p><img src="p2-01-marriages_files/figure-html/unnamed-chunk-19-1.png" width="960" /></p>
<p>Looking at different dimensions men are the majority of the second mode.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb83-1"><a href="marriages-in-pakistan.html#cb83-1"></a>roster_enriched <span class="sc">%&gt;%</span> </span>
<span id="cb83-2"><a href="marriages-in-pakistan.html#cb83-2"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(work1_income_last_year), work1_income_last_year <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb83-3"><a href="marriages-in-pakistan.html#cb83-3"></a>         <span class="sc">!</span><span class="fu">is.na</span>(age)) <span class="sc">%&gt;%</span> </span>
<span id="cb83-4"><a href="marriages-in-pakistan.html#cb83-4"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> work1_income_last_year, <span class="at">color =</span> has_spouse)) <span class="sc">+</span> </span>
<span id="cb83-5"><a href="marriages-in-pakistan.html#cb83-5"></a>  <span class="fu">geom_mark_ellipse</span>(<span class="fu">aes</span>(<span class="at">filter =</span> <span class="fu">between</span>(work1_income_last_year, <span class="dv">50</span>, <span class="dv">1000</span>) <span class="sc">&amp;</span> <span class="fu">between</span>(age, <span class="dv">20</span>, <span class="dv">80</span>)), </span>
<span id="cb83-6"><a href="marriages-in-pakistan.html#cb83-6"></a>                    <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb83-7"><a href="marriages-in-pakistan.html#cb83-7"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb83-8"><a href="marriages-in-pakistan.html#cb83-8"></a>  <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> <span class="fu">label_comma</span>()) <span class="sc">+</span></span>
<span id="cb83-9"><a href="marriages-in-pakistan.html#cb83-9"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="dv">1</span>))) <span class="sc">+</span> </span>
<span id="cb83-10"><a href="marriages-in-pakistan.html#cb83-10"></a>  <span class="fu">facet_grid</span>(has_spouse <span class="sc">~</span> sex) <span class="sc">+</span></span>
<span id="cb83-11"><a href="marriages-in-pakistan.html#cb83-11"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Age&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Annual Income (PKR)&quot;</span>, <span class="at">color =</span> <span class="st">&quot;Married?&quot;</span>)</span></code></pre></div>
<p><img src="p2-01-marriages_files/figure-html/unnamed-chunk-20-1.png" width="960" /></p>
<p>Looking at the most common industries the second mode is basically only present in agriculture.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb84-1"><a href="marriages-in-pakistan.html#cb84-1"></a>roster_enriched <span class="sc">%&gt;%</span> </span>
<span id="cb84-2"><a href="marriages-in-pakistan.html#cb84-2"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(work1_income_last_year), work1_income_last_year <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb84-3"><a href="marriages-in-pakistan.html#cb84-3"></a>         <span class="sc">!</span><span class="fu">is.na</span>(age),</span>
<span id="cb84-4"><a href="marriages-in-pakistan.html#cb84-4"></a>         <span class="sc">!</span>has_spouse, sex <span class="sc">==</span> <span class="st">&quot;male&quot;</span>, <span class="sc">!</span><span class="fu">is.na</span>(work1_industry),</span>
<span id="cb84-5"><a href="marriages-in-pakistan.html#cb84-5"></a>         region <span class="sc">==</span> <span class="st">&quot;Rural&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb84-6"><a href="marriages-in-pakistan.html#cb84-6"></a>  <span class="fu">mutate</span>(<span class="at">work1_industry =</span> <span class="fu">fct_lump_n</span>(work1_industry, <span class="dv">8</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb84-7"><a href="marriages-in-pakistan.html#cb84-7"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> work1_income_last_year, <span class="at">color =</span> work1_industry)) <span class="sc">+</span> </span>
<span id="cb84-8"><a href="marriages-in-pakistan.html#cb84-8"></a>  <span class="fu">geom_mark_ellipse</span>(<span class="fu">aes</span>(<span class="at">filter =</span> <span class="fu">between</span>(work1_income_last_year, <span class="dv">50</span>, <span class="dv">1000</span>) <span class="sc">&amp;</span> <span class="fu">between</span>(age, <span class="dv">20</span>, <span class="dv">80</span>)), </span>
<span id="cb84-9"><a href="marriages-in-pakistan.html#cb84-9"></a>                    <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-10"><a href="marriages-in-pakistan.html#cb84-10"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb84-11"><a href="marriages-in-pakistan.html#cb84-11"></a>  <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> <span class="fu">label_comma</span>()) <span class="sc">+</span></span>
<span id="cb84-12"><a href="marriages-in-pakistan.html#cb84-12"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span> </span>
<span id="cb84-13"><a href="marriages-in-pakistan.html#cb84-13"></a>  <span class="co"># guides(color = guide_legend(override.aes = list(alpha = 1))) + </span></span>
<span id="cb84-14"><a href="marriages-in-pakistan.html#cb84-14"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>work1_industry) <span class="sc">+</span></span>
<span id="cb84-15"><a href="marriages-in-pakistan.html#cb84-15"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Age&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Annual Income (PKR)&quot;</span>)</span></code></pre></div>
<p><img src="p2-01-marriages_files/figure-html/unnamed-chunk-21-1.png" width="960" /></p>
<p>Within agriculture basically only 1 occupation is responsible for the mode.</p>
<p>There is a trend in agricultural communities for workers to be paid in form of room and board instead of cash. If I had loaded the other payment types then I could have verified this hypothesis.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb85-1"><a href="marriages-in-pakistan.html#cb85-1"></a>roster_enriched <span class="sc">%&gt;%</span> </span>
<span id="cb85-2"><a href="marriages-in-pakistan.html#cb85-2"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(work1_income_last_year), work1_income_last_year <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb85-3"><a href="marriages-in-pakistan.html#cb85-3"></a>         <span class="sc">!</span><span class="fu">is.na</span>(age),</span>
<span id="cb85-4"><a href="marriages-in-pakistan.html#cb85-4"></a>         <span class="sc">!</span>has_spouse, sex <span class="sc">==</span> <span class="st">&quot;male&quot;</span>, <span class="sc">!</span><span class="fu">is.na</span>(work1_industry),</span>
<span id="cb85-5"><a href="marriages-in-pakistan.html#cb85-5"></a>         region <span class="sc">==</span> <span class="st">&quot;Rural&quot;</span>, work1_industry <span class="sc">==</span> <span class="st">&quot;Agriculture, forestry, fishing&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb85-6"><a href="marriages-in-pakistan.html#cb85-6"></a>  <span class="fu">mutate</span>(<span class="at">work1_occupation =</span> <span class="fu">fct_lump_n</span>(work1_occupation, <span class="dv">8</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb85-7"><a href="marriages-in-pakistan.html#cb85-7"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> work1_income_last_year, <span class="at">color =</span> work1_occupation)) <span class="sc">+</span> </span>
<span id="cb85-8"><a href="marriages-in-pakistan.html#cb85-8"></a>  <span class="fu">geom_mark_ellipse</span>(<span class="fu">aes</span>(<span class="at">filter =</span> <span class="fu">between</span>(work1_income_last_year, <span class="dv">50</span>, <span class="dv">1000</span>) <span class="sc">&amp;</span> <span class="fu">between</span>(age, <span class="dv">20</span>, <span class="dv">80</span>)), </span>
<span id="cb85-9"><a href="marriages-in-pakistan.html#cb85-9"></a>                    <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb85-10"><a href="marriages-in-pakistan.html#cb85-10"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb85-11"><a href="marriages-in-pakistan.html#cb85-11"></a>  <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> <span class="fu">label_comma</span>()) <span class="sc">+</span></span>
<span id="cb85-12"><a href="marriages-in-pakistan.html#cb85-12"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span> </span>
<span id="cb85-13"><a href="marriages-in-pakistan.html#cb85-13"></a>  <span class="co"># guides(color = guide_legend(override.aes = list(alpha = 1))) + </span></span>
<span id="cb85-14"><a href="marriages-in-pakistan.html#cb85-14"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>work1_occupation) <span class="sc">+</span></span>
<span id="cb85-15"><a href="marriages-in-pakistan.html#cb85-15"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Age&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Annual Income (PKR)&quot;</span>)</span></code></pre></div>
<p><img src="p2-01-marriages_files/figure-html/unnamed-chunk-22-1.png" width="960" /></p>
<p>It appears the effect of marraige on income is reversed for men and women. (TODO: check this using a model)</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb86-1"><a href="marriages-in-pakistan.html#cb86-1"></a>roster_enriched <span class="sc">%&gt;%</span> </span>
<span id="cb86-2"><a href="marriages-in-pakistan.html#cb86-2"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(work1_income_last_year)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-3"><a href="marriages-in-pakistan.html#cb86-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> work1_income_last_year, <span class="at">group =</span> <span class="fu">interaction</span>(year, has_spouse), <span class="at">fill =</span> has_spouse)) <span class="sc">+</span> </span>
<span id="cb86-4"><a href="marriages-in-pakistan.html#cb86-4"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb86-5"><a href="marriages-in-pakistan.html#cb86-5"></a>  <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> <span class="fu">label_comma</span>()) <span class="sc">+</span> </span>
<span id="cb86-6"><a href="marriages-in-pakistan.html#cb86-6"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>sex) <span class="sc">+</span> </span>
<span id="cb86-7"><a href="marriages-in-pakistan.html#cb86-7"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Annual Income (PKR)&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Transformation introduced infinite values in continuous y-axis</code></pre>
<pre><code>## Warning: Removed 514264 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="p2-01-marriages_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>income of couples</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb89-1"><a href="marriages-in-pakistan.html#cb89-1"></a>couples_enriched <span class="ot">&lt;-</span> couples <span class="sc">%&gt;%</span> </span>
<span id="cb89-2"><a href="marriages-in-pakistan.html#cb89-2"></a>  <span class="fu">left_join</span>(income <span class="sc">%&gt;%</span> <span class="fu">select</span>(year,hhcode,idc,work1_income_last_year) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">annual_income.husband =</span> work1_income_last_year),</span>
<span id="cb89-3"><a href="marriages-in-pakistan.html#cb89-3"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;hhcode&quot;</span>, <span class="st">&quot;idc.husband&quot;</span> <span class="ot">=</span> <span class="st">&quot;idc&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb89-4"><a href="marriages-in-pakistan.html#cb89-4"></a>  <span class="fu">left_join</span>(income <span class="sc">%&gt;%</span> <span class="fu">select</span>(year,hhcode,idc,work1_income_last_year) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">annual_income.wife =</span> work1_income_last_year),</span>
<span id="cb89-5"><a href="marriages-in-pakistan.html#cb89-5"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;hhcode&quot;</span>, <span class="st">&quot;idc.wife&quot;</span> <span class="ot">=</span> <span class="st">&quot;idc&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb89-6"><a href="marriages-in-pakistan.html#cb89-6"></a>  <span class="fu">mutate</span>(<span class="at">annual_income_gap =</span> annual_income.husband <span class="sc">-</span> annual_income.wife,</span>
<span id="cb89-7"><a href="marriages-in-pakistan.html#cb89-7"></a>         <span class="at">is_earning.husband =</span> (annual_income.husband <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">&amp;</span> (<span class="sc">!</span><span class="fu">is.na</span>(annual_income.husband)),</span>
<span id="cb89-8"><a href="marriages-in-pakistan.html#cb89-8"></a>         <span class="at">is_earning.wife =</span> (annual_income.wife <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">&amp;</span> (<span class="sc">!</span><span class="fu">is.na</span>(annual_income.wife)),</span>
<span id="cb89-9"><a href="marriages-in-pakistan.html#cb89-9"></a>         <span class="at">who_earns =</span> <span class="fu">case_when</span>(is_earning.husband <span class="sc">&amp;</span> is_earning.wife <span class="sc">~</span> <span class="st">&quot;Both&quot;</span>,</span>
<span id="cb89-10"><a href="marriages-in-pakistan.html#cb89-10"></a>                               is_earning.husband <span class="sc">&amp;</span> <span class="sc">!</span>is_earning.wife <span class="sc">~</span> <span class="st">&quot;Husband only&quot;</span>,</span>
<span id="cb89-11"><a href="marriages-in-pakistan.html#cb89-11"></a>                               <span class="sc">!</span>is_earning.husband <span class="sc">&amp;</span> is_earning.wife <span class="sc">~</span> <span class="st">&quot;Wife only&quot;</span>,</span>
<span id="cb89-12"><a href="marriages-in-pakistan.html#cb89-12"></a>                               <span class="sc">!</span>is_earning.husband <span class="sc">&amp;</span> <span class="sc">!</span>is_earning.wife <span class="sc">~</span> <span class="st">&quot;Neither&quot;</span>),</span>
<span id="cb89-13"><a href="marriages-in-pakistan.html#cb89-13"></a>         <span class="at">who_earns =</span> <span class="fu">fct_relevel</span>(<span class="fu">as_factor</span>(who_earns), <span class="st">&quot;Both&quot;</span>,<span class="st">&quot;Husband only&quot;</span>,<span class="st">&quot;Wife only&quot;</span>,<span class="st">&quot;Neither&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb89-14"><a href="marriages-in-pakistan.html#cb89-14"></a>  <span class="fu">select</span>(year, hhcode, province, district, region, </span>
<span id="cb89-15"><a href="marriages-in-pakistan.html#cb89-15"></a>         idc.husband, age.husband, age_group.husband, annual_income.husband,</span>
<span id="cb89-16"><a href="marriages-in-pakistan.html#cb89-16"></a>         idc.wife, age.wife, age_group.wife, annual_income.wife,</span>
<span id="cb89-17"><a href="marriages-in-pakistan.html#cb89-17"></a>         age_gap, annual_income_gap, who_earns)</span>
<span id="cb89-18"><a href="marriages-in-pakistan.html#cb89-18"></a></span>
<span id="cb89-19"><a href="marriages-in-pakistan.html#cb89-19"></a><span class="fu">head</span>(couples_enriched)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 16
##   year           hhcode province district region idc.husband age.husband
##   &lt;date&gt;          &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;    &lt;fct&gt;        &lt;dbl&gt;       &lt;dbl&gt;
## 1 2005-01-01 1011010101 Punjab   &lt;NA&gt;     Urban            1          64
## 2 2005-01-01 1011010102 Punjab   &lt;NA&gt;     Urban            1          35
## 3 2005-01-01 1011010103 Punjab   &lt;NA&gt;     Urban            1          70
## 4 2005-01-01 1011010104 Punjab   &lt;NA&gt;     Urban            1          40
## 5 2005-01-01 1011010105 Punjab   &lt;NA&gt;     Urban            1          49
## 6 2005-01-01 1011010106 Punjab   &lt;NA&gt;     Urban            1          30
## # ... with 9 more variables: age_group.husband &lt;ord&gt;,
## #   annual_income.husband &lt;dbl&gt;, idc.wife &lt;dbl&gt;, age.wife &lt;dbl&gt;,
## #   age_group.wife &lt;ord&gt;, annual_income.wife &lt;dbl&gt;, age_gap &lt;dbl&gt;,
## #   annual_income_gap &lt;dbl&gt;, who_earns &lt;fct&gt;</code></pre>
<p>who earns</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb91-1"><a href="marriages-in-pakistan.html#cb91-1"></a>couples_enriched <span class="sc">%&gt;%</span> </span>
<span id="cb91-2"><a href="marriages-in-pakistan.html#cb91-2"></a>  <span class="fu">count</span>(year, region, who_earns) <span class="sc">%&gt;%</span> </span>
<span id="cb91-3"><a href="marriages-in-pakistan.html#cb91-3"></a>  <span class="fu">group_by</span>(year, region) <span class="sc">%&gt;%</span> </span>
<span id="cb91-4"><a href="marriages-in-pakistan.html#cb91-4"></a>  <span class="fu">mutate</span>(<span class="at">pct =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb91-5"><a href="marriages-in-pakistan.html#cb91-5"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb91-6"><a href="marriages-in-pakistan.html#cb91-6"></a>  <span class="fu">mutate</span>(<span class="at">who_earns =</span> <span class="fu">fct_reorder</span>(who_earns, n)) <span class="sc">%&gt;%</span> </span>
<span id="cb91-7"><a href="marriages-in-pakistan.html#cb91-7"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> pct, <span class="at">fill =</span> who_earns)) <span class="sc">+</span></span>
<span id="cb91-8"><a href="marriages-in-pakistan.html#cb91-8"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb91-9"><a href="marriages-in-pakistan.html#cb91-9"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_percent</span>()) <span class="sc">+</span> </span>
<span id="cb91-10"><a href="marriages-in-pakistan.html#cb91-10"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>region) <span class="sc">+</span></span>
<span id="cb91-11"><a href="marriages-in-pakistan.html#cb91-11"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Percentage of couples&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Who earns in a marriage?&quot;</span>, <span class="at">color =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="p2-01-marriages_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>dist of income gap</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb92-1"><a href="marriages-in-pakistan.html#cb92-1"></a>couples_enriched <span class="sc">%&gt;%</span> </span>
<span id="cb92-2"><a href="marriages-in-pakistan.html#cb92-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> annual_income_gap)) <span class="sc">+</span></span>
<span id="cb92-3"><a href="marriages-in-pakistan.html#cb92-3"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span> </span>
<span id="cb92-4"><a href="marriages-in-pakistan.html#cb92-4"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label =</span> <span class="fu">label_comma</span>()) <span class="sc">+</span> </span>
<span id="cb92-5"><a href="marriages-in-pakistan.html#cb92-5"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> who_earns, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in self$trans$transform(x): NaNs produced</code></pre>
<pre><code>## Warning: Transformation introduced infinite values in continuous x-axis</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 319137 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="p2-01-marriages_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>couple correlation</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb97-1"><a href="marriages-in-pakistan.html#cb97-1"></a>couples_enriched <span class="sc">%&gt;%</span> </span>
<span id="cb97-2"><a href="marriages-in-pakistan.html#cb97-2"></a>  <span class="co"># filter(who_earns == &quot;Both&quot;) %&gt;% </span></span>
<span id="cb97-3"><a href="marriages-in-pakistan.html#cb97-3"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> annual_income.husband, <span class="at">y =</span> annual_income.wife)) <span class="sc">+</span> </span>
<span id="cb97-4"><a href="marriages-in-pakistan.html#cb97-4"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">abs</span>(annual_income_gap) <span class="sc">&gt;</span> <span class="dv">100000</span>), <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb97-5"><a href="marriages-in-pakistan.html#cb97-5"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#C3C3C3&quot;</span>, <span class="st">&quot;#198D8D&quot;</span>)) <span class="sc">+</span></span>
<span id="cb97-6"><a href="marriages-in-pakistan.html#cb97-6"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb97-7"><a href="marriages-in-pakistan.html#cb97-7"></a>  <span class="fu">scale_x_log10</span>(<span class="at">labels =</span> <span class="fu">label_comma</span>()) <span class="sc">+</span></span>
<span id="cb97-8"><a href="marriages-in-pakistan.html#cb97-8"></a>  <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> <span class="fu">label_comma</span>()) <span class="sc">+</span></span>
<span id="cb97-9"><a href="marriages-in-pakistan.html#cb97-9"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb97-10"><a href="marriages-in-pakistan.html#cb97-10"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> region) <span class="sc">+</span> </span>
<span id="cb97-11"><a href="marriages-in-pakistan.html#cb97-11"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="dv">1</span>))) <span class="sc">+</span> </span>
<span id="cb97-12"><a href="marriages-in-pakistan.html#cb97-12"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Husband&#39;s annual income&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Wife&#39;s annual income&quot;</span>, <span class="at">color =</span> <span class="st">&quot;Annual income gap &gt; 1 lakh PKR&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Transformation introduced infinite values in continuous x-axis</code></pre>
<pre><code>## Warning: Transformation introduced infinite values in continuous y-axis</code></pre>
<pre><code>## Warning: Removed 304223 rows containing missing values (geom_point).</code></pre>
<p><img src="p2-01-marriages_files/figure-html/unnamed-chunk-27-1.png" width="960" /></p>
<p>correlation of income gap with age gap</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb101-1"><a href="marriages-in-pakistan.html#cb101-1"></a>couples_enriched <span class="sc">%&gt;%</span> </span>
<span id="cb101-2"><a href="marriages-in-pakistan.html#cb101-2"></a>  <span class="co"># filter(who_earns != &quot;Neither&quot;) %&gt;%</span></span>
<span id="cb101-3"><a href="marriages-in-pakistan.html#cb101-3"></a>  <span class="fu">filter</span>(who_earns <span class="sc">==</span> <span class="st">&quot;Both&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb101-4"><a href="marriages-in-pakistan.html#cb101-4"></a>  <span class="fu">mutate</span>(<span class="at">ag.h =</span> <span class="fu">ntile</span>(age.husband, <span class="dv">4</span>), </span>
<span id="cb101-5"><a href="marriages-in-pakistan.html#cb101-5"></a>         <span class="at">ag.w =</span> <span class="fu">ntile</span>(age.wife, <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb101-6"><a href="marriages-in-pakistan.html#cb101-6"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age_gap, <span class="at">y =</span> annual_income_gap, <span class="at">color =</span> region)) <span class="sc">+</span> </span>
<span id="cb101-7"><a href="marriages-in-pakistan.html#cb101-7"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb101-8"><a href="marriages-in-pakistan.html#cb101-8"></a>  <span class="co"># geom_smooth() + </span></span>
<span id="cb101-9"><a href="marriages-in-pakistan.html#cb101-9"></a>  <span class="co"># scale_color_manual(values = c(&quot;#C3C3C3&quot;, &quot;#198D8D&quot;)) + </span></span>
<span id="cb101-10"><a href="marriages-in-pakistan.html#cb101-10"></a>  <span class="co"># geom_abline(slope = 1, intercept = 0, linetype = &quot;dashed&quot;) +</span></span>
<span id="cb101-11"><a href="marriages-in-pakistan.html#cb101-11"></a>  <span class="co"># scale_x_log10(labels = label_comma()) +</span></span>
<span id="cb101-12"><a href="marriages-in-pakistan.html#cb101-12"></a>  <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> <span class="fu">label_comma</span>()) <span class="sc">+</span></span>
<span id="cb101-13"><a href="marriages-in-pakistan.html#cb101-13"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb101-14"><a href="marriages-in-pakistan.html#cb101-14"></a>  <span class="co"># coord_fixed() +&#39;</span></span>
<span id="cb101-15"><a href="marriages-in-pakistan.html#cb101-15"></a>  <span class="co"># facet_wrap(~ region) + </span></span>
<span id="cb101-16"><a href="marriages-in-pakistan.html#cb101-16"></a>  <span class="co"># facet_grid(ag.w ~ ag.h) + </span></span>
<span id="cb101-17"><a href="marriages-in-pakistan.html#cb101-17"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Age gap&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Annual income gap (PKR)&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in self$trans$transform(x): NaNs produced</code></pre>
<pre><code>## Warning: Transformation introduced infinite values in continuous y-axis</code></pre>
<pre><code>## Warning: Removed 668 rows containing missing values (geom_point).</code></pre>
<p><img src="p2-01-marriages_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="employment.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/Rabeez/pslm-stories/edit/master/p2-01-marriages.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/Rabeez/pslm-stories/blob/master/p2-01-marriages.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"description": "Illustrative analyses on cleaned PSLM data.",
"url": "https\://rabeez.github.io/pslm-stories/index.html",
"github-repo": "Rabeez/pslm-stories",
"cover-image": "favicon.png",
"favicon": "favicon.png",
"df_print": "paged",
"toolbar": {
"position": "fixed"
},
"search": true,
"info": true
});
});
</script>

</body>

</html>
